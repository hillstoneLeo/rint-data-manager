services:
  test_client:
    build:
      context: ..
      dockerfile: ./test/Dockerfile.test-client
      args:
        DEV_SERVER_IP: ${DEV_SERVER_IP:-10.160.43.100}
        DEV_SERVER_PORT: ${SERVER_PORT:-8383}
    container_name: rdm-test-client
    environment:
      - CONTAINER_NAME=test_client
      - DEV_SERVER_IP=${DEV_SERVER_IP:-10.160.43.100}
      - DEV_SERVER_PORT=${SERVER_PORT:-8383}
      - SETUP_DVC=${SETUP_DVC:-yes}

    volumes:
      - test_client_data:/home
      - ./.env:/test/.env:ro  # Mount environment file for reference
    network_mode: host  # Use host network to access dev server directly
    restart: unless-stopped
    stdin_open: true  # Keep STDIN open for interactive sessions
    tty: true         # Allocate a TTY

volumes:
  test_client_data:
