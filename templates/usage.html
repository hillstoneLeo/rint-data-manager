<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>使用说明 - RINT 数据分享平台</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/style.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">RINT 数据分享平台</a>
            <div class="navbar-nav ms-auto" id="navbarNav">
                <a class="nav-link active" href="/usage">使用说明</a>
                {% if current_user %}
                    <a class="nav-link" href="/dashboard">数据仓库</a>
                    {% if current_user.is_admin %}
                        <a class="nav-link" href="/admin">Admin Panel</a>
                    {% endif %}
                    <div class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <span id="currentUserEmail">{{ current_user.email }}</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                            <li><a class="dropdown-item" href="#" onclick="logout()">Logout</a></li>
                        </ul>
                    </div>
                {% else %}
                    <a class="nav-link" href="/login">Login</a>
                    <a class="nav-link" href="/register">Register</a>
                {% endif %}
            </div>
        </div>
    </nav>

    <div class="container mt-5">
        <div class="row">
            <div class="col-md-12">
                <h1 class="mb-4">使用说明</h1>
                
                <div class="card mb-4">
                    <div class="card-header">
                        <h3>系统概述</h3>
                    </div>
                    <div class="card-body">
                        <p>RINT 数据分享平台是一个基于 DVC (Data Version Control) 的数据收集和分享平台。用户可以通过两种主要方式上传和管理数据：</p>
                        <ul>
                            <li><strong>Web 页面上传</strong>：通过浏览器界面直接上传文件和文件夹</li>
                            <li><strong>Git + DVC 命令行</strong>：通过 git commit 和 dvc push 命令上传数据</li>
                        </ul>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <h3>方法一：通过 Web 页面上传</h3>
                    </div>
                    <div class="card-body">
                        <h4>步骤 1：注册和登录</h4>
                        <ol>
                            <li>访问平台主页，点击 "Register" 创建账户</li>
                            <li>使用邮箱和密码登录系统</li>
                            <li>登录后自动跳转到数据仓库页面</li>
                        </ol>

                        <h4>步骤 2：上传数据</h4>
                        <ol>
                            <li>在数据仓库页面，点击 "Upload Data" 按钮</li>
                            <li>选择上传类型：
                                <ul>
                                    <li><strong>Files</strong>：上传一个或多个文件</li>
                                    <li><strong>Folder</strong>：上传整个文件夹</li>
                                </ul>
                            </li>
                            <li>选择要上传的文件或文件夹</li>
                            <li>填写数据源信息（必填）</li>
                            <li>添加数据描述（可选）</li>
                            <li>选择父数据项（可选，用于建立数据关系）</li>
                            <li>点击 "Upload" 开始上传</li>
                        </ol>

                        <h4>步骤 3：管理数据</h4>
                        <ul>
                            <li>查看已上传的数据项列表</li>
                            <li>使用 "只显示我的数据" 筛选个人数据</li>
                            <li>点击 "View Lineage" 查看数据关系和血缘</li>
                        </ul>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <h3>方法二：通过 Git Commit + DVC Push 上传</h3>
                    </div>
                    <div class="card-body">
                        <h4>前提条件</h4>
                        <ul>
                            <li>已安装 Git</li>
                            <li>已安装 DVC</li>
                            <li>拥有平台的 Git 仓库访问权限</li>
                        </ul>

                        <h4>步骤 1：克隆仓库</h4>
                        <pre><code>git clone &lt;repository-url&gt;
cd &lt;repository-name&gt;</code></pre>

                        <h4>步骤 2：初始化 DVC</h4>
                        <pre><code>dvc init</code></pre>

                        <h4>步骤 3：配置 DVC 远程存储</h4>
                        <pre><code>dvc remote add -d myremote &lt;dvc-storage-url&gt;</code></pre>

                        <h4>步骤 4：添加数据到 DVC</h4>
                        <pre><code># 添加单个文件
dvc add data/file.csv

# 添加整个文件夹
dvc add data/dataset/</code></pre>

                        <h4>步骤 5：提交更改到 Git</h4>
                        <pre><code>git add .
git commit -m "Add data files via DVC"</code></pre>

                        <h4>步骤 6：推送数据到远程存储</h4>
                        <pre><code># 推送 DVC 数据
dvc push

# 推送 Git 更改
git push</code></pre>

                        <h4>步骤 7：拉取数据</h4>
                        <pre><code># 拉取 DVC 数据
dvc pull

# 拉取 Git 更改
git pull</code></pre>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <h3>数据血缘管理</h3>
                    </div>
                    <div class="card-body">
                        <h4>Web 界面中的血缘关系</h4>
                        <ul>
                            <li>在上传数据时，可以指定父数据项来建立关系</li>
                            <li>在数据仓库页面，点击 "View Lineage" 查看数据的父子关系</li>
                            <li>血缘关系帮助追踪数据的来源和衍生关系</li>
                        </ul>

                        <h4>DVC 中的血缘关系</h4>
                        <ul>
                            <li>DVC 自动跟踪数据文件的依赖关系</li>
                            <li>通过 DVC 管道可以定义复杂的数据处理流程</li>
                            <li>使用 <code>dvc dag</code> 命令可视化数据流程图</li>
                        </ul>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <h3>管理员功能</h3>
                    </div>
                    <div class="card-body">
                        <p>管理员用户可以访问以下功能：</p>
                        <ul>
                            <li><strong>用户管理</strong>：查看、创建、删除用户账户</li>
                            <li><strong>权限管理</strong>：授予或撤销管理员权限</li>
                            <li><strong>密码重置</strong>：为用户重置密码</li>
                            <li><strong>数据监控</strong>：查看所有用户的数据上传情况</li>
                        </ul>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header">
                        <h3>常见问题</h3>
                    </div>
                    <div class="card-body">
                        <h4>Q: 支持哪些文件格式？</h4>
                        <p>A: 平台支持所有文件格式，包括 CSV、JSON、图片、视频、文档等。</p>

                        <h4>Q: 数据上传大小有限制吗？</h4>
                        <p>A: 单个文件大小限制为 2GB，文件夹上传没有总大小限制，但建议分批上传大型数据集。</p>

                        <h4>Q: 如何分享数据给其他用户？</h4>
                        <p>A: 所有注册用户都可以查看平台上的数据。如需限制访问，请联系管理员设置权限。</p>

                        <h4>Q: DVC 推送失败怎么办？</h4>
                        <p>A: 检查网络连接，确认 DVC 远程配置正确，验证存储权限。使用 <code>dvc status</code> 查看同步状态。</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
        function logout() {
            localStorage.removeItem('token');
            // Clear the cookie as well
            document.cookie = 'access_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 UTC; SameSite=Strict';
            window.location.reload();
        }
    </script>
</body>
</html>